var nt=Object.defineProperty;var ot=(i,s,a)=>s in i?nt(i,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[s]=a;var w=(i,s,a)=>(ot(i,typeof s!="symbol"?s+"":s,a),a);import{s as rt,o as it,n as ct}from"../chunks/scheduler.b0c1c2c3.js";import{S as lt,i as pt,r as q,u as R,v as z,d as I,t as A,w as D,g as mt,s as K,h as ut,z as ft,c as N,a as P,f as T}from"../chunks/index.f44ac6f0.js";import{O as X,V as k,i as dt,j as ht,B as wt,k as gt,M as $t,l as xt,S as vt,H as yt,r as Ct,m as Et,n as Mt,o as _t,Q as S,p as bt,E as Vt,s as Ht,u as Pt,A as Tt,h as kt,q as St,C as qt}from"../chunks/setup.f293222f.js";import{G as Rt}from"../chunks/index.6f29f975.js";import{D as zt,C as It}from"../chunks/code.749cf45e.js";const At=i=>new Et({color:i,toneMapped:!1}),Dt=(i,s)=>{const a=document.createElement("canvas"),t=a.getContext("2d");a.width=64,a.height=64,t!==null&&(t.beginPath(),t.arc(32,32,16,0,2*Math.PI),t.closePath(),t.fillStyle=(i==null?void 0:i.getStyle())??"",t.fill(),s!==void 0&&(t.font="24px system-ui",t.textAlign="center",t.fillStyle="#000000",t.fillText(s.toUpperCase(),32,41)));const r=new Mt(a);return new _t({map:r,toneMapped:!1})};class Lt extends X{constructor(a,t,r={}){var j,J;super();w(this,"isViewHelper",!0);w(this,"animating",!1);w(this,"center",new k);w(this,"turnRate",2*Math.PI);w(this,"dispose");const p=["x","y","z","x","y","z"],{position:m="top-right"}=r,u=t.domElement,o=new dt,f=window.devicePixelRatio,Y=r.colors??["#ff3653","#8adb00","#2c8fff"],x=new k,L=new S,M=new bt,v=new S,_=new S,h=new Vt,Q=new ht;let b=0;const G=new wt(.8,.05,.05).translate(.4,0,0),O=Y.map(e=>new gt(e)),y=O.map(e=>new $t(G,At(e))),g=new X,B=new xt(-2,2,2,-2,0,4);B.position.set(0,0,2);const V=new k,c=220,$=document.createElement("div");u.before($),(j=y[1])==null||j.rotation.set(0,0,Math.PI/2),(J=y[2])==null||J.rotation.set(0,-Math.PI/2,0),y.forEach(e=>this.add(e));const C=p.map((e,n)=>{const l=n>2?-1:1,E=Dt(O[n%3],l===1?e:void 0),d=new vt(E);return d.position[e]=l,d.scale.setScalar(l===1?1:.8),d.userData={name:e,sign:l},d});C.forEach(e=>this.add(e));const U=C.map(e=>{const n=document.createElement("div");return n.dataset.axis=e.userData.name,n.dataset.sign=e.userData.sign===1?"":"-",n.style.cssText=`
        position: absolute;
        width: 15px;
        height: 15px;
        border-radius: 100%;
        cursor: pointer;
      `,new yt({element:n,object3D:e,target:$})}),Z=Ct(u,e=>{o.x=e.width,o.y=e.height,$.style.cssText=`
        position: absolute;
        top: ${u.offsetTop}px;
        left: ${u.offsetLeft+(e.width-c/2)}px;
        width: ${c/2}px;
        height: ${c/2}px;
      `});let F=!1;const H=t.render,tt=e=>{switch(e){case"x":return h.set(0,Math.PI*.5,0);case"y":return h.set(-Math.PI*.5,0,0);case"z":return h.set(0,0,0);case"-x":return h.set(0,-Math.PI*.5,0);case"-y":return h.set(Math.PI*.5,0,0);case"-z":return h.set(0,Math.PI,0)}},et=()=>{this.quaternion.copy(a.quaternion).invert(),V.set(0,0,1).applyQuaternion(a.quaternion),p.forEach((l,E)=>{const d=C[E];d!==void 0&&(E<3?d.material.opacity=V[l]>=0?1:.5:d.material.opacity=V[l]<0?1:.5)}),F=t.autoClear,t.autoClear=!1,t.clearDepth(),t.getViewport(Q);const e=o.x*f,n=o.y*f;switch(m){case"top-right":{t.setViewport(e-c,n-c,c,c);break}case"bottom-right":{t.setViewport(e-c,0,c,c);break}case"bottom-left":{t.setViewport(0,0,c,c);break}case"top-left":{t.setViewport(0,n-c,c,c);break}}H.call(t,this,B),t.setViewport(Q),t.autoClear=F},st=()=>{const n=M.getDelta()*this.turnRate;v.rotateTowards(_,n),a.position.set(0,0,1).applyQuaternion(v).multiplyScalar(b).add(this.center),a.quaternion.rotateTowards(L,n),v.angleTo(_)===0&&(this.animating=!1,M.stop())},at=(e,n,l)=>{x.set(0,0,0),x[e]=n==="-"?-1:1,L.setFromEuler(tt(`${n}${e}`)),b=a.position.distanceTo(l),x.multiplyScalar(b).add(l),g.position.copy(l),g.lookAt(a.position),v.copy(g.quaternion),g.lookAt(x),_.copy(g.quaternion)},W=e=>{if(this.animating)return;const{axis:n,sign:l}=e.currentTarget.dataset;at(n,l,this.center),M.start(),this.animating=!0};U.forEach(e=>{var n;return(n=e.element)==null?void 0:n.addEventListener("click",W)}),t.render=(...e)=>{H.call(t,...e),et(),this.animating&&st()},this.dispose=()=>{t.render=H,U.forEach(e=>{var n;(n=e.element)==null||n.remove(),e.dispose()}),$.removeEventListener("click",W),$.remove(),Z.disconnect(),G.dispose(),y.forEach(e=>e.material.dispose()),C.forEach(e=>{var n;(n=e.material.map)==null||n.dispose(),e.material.dispose()})}}}const Qt=`
import * as THREE from 'three'
import { ViewHelper } from 'trzy'

const camera = new THREE.PerspectiveCamera()
const renderer = new THREE.WebGLRenderer()
const helper = new ViewHelper(camera, renderer)
`;function Gt(i){let s,a="Creates a HUD view helper.",t,r,p,m,u;return r=new qt({}),m=new It({props:{code:Qt}}),{c(){s=mt("p"),s.textContent=a,t=K(),q(r.$$.fragment),p=K(),q(m.$$.fragment)},l(o){s=ut(o,"P",{"data-svelte-h":!0}),ft(s)!=="svelte-3wvkbi"&&(s.textContent=a),t=N(o),R(r.$$.fragment,o),p=N(o),R(m.$$.fragment,o)},m(o,f){P(o,s,f),P(o,t,f),z(r,o,f),P(o,p,f),z(m,o,f),u=!0},p:ct,i(o){u||(I(r.$$.fragment,o),I(m.$$.fragment,o),u=!0)},o(o){A(r.$$.fragment,o),A(m.$$.fragment,o),u=!1},d(o){o&&(T(s),T(t),T(p)),D(r,o),D(m,o)}}}function Ot(i){let s,a;return s=new zt({props:{title:"ViewHelper",$$slots:{default:[Gt]},$$scope:{ctx:i}}}),{c(){q(s.$$.fragment)},l(t){R(s.$$.fragment,t)},m(t,r){z(s,t,r),a=!0},p(t,[r]){const p={};r&1&&(p.$$scope={dirty:r,ctx:t}),s.$set(p)},i(t){a||(I(s.$$.fragment,t),a=!0)},o(t){A(s.$$.fragment,t),a=!1},d(t){D(s,t)}}}function Bt(i){return it(()=>{const s=Ht();s.autoRotate=!1;const{scene:a,camera:t,renderer:r}=Pt(),p=new Lt(t.current,r);return a.add(new Rt(.1,1,"#ccc")),a.add(new Tt),a.add(kt(St({color:"turquoise"}),.5,.4,.3)),()=>{s.autoRotate=!0,p.dispose()}}),[]}class Nt extends lt{constructor(s){super(),pt(this,s,Bt,Ot,rt,{})}}export{Nt as component};
