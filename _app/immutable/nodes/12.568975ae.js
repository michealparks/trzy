var ot=Object.defineProperty;var nt=(l,s,n)=>s in l?ot(l,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[s]=n;var w=(l,s,n)=>(nt(l,typeof s!="symbol"?s+"":s,n),n);import{s as rt,o as it,n as ct}from"../chunks/scheduler.b0c1c2c3.js";import{S as lt,i as pt,r as D,u as I,v as A,d as S,t as L,w as Q,g as mt,s as K,h as ut,z as ft,c as N,a as P,f as q}from"../chunks/index.f44ac6f0.js";import{O as X,V as R,i as dt,j as ht,B as wt,k as $t,M as gt,l as xt,m as vt,S as yt,H as Et,r as Ct,n as _t,Q as z,o as Mt,E as bt,s as Vt,u as Ht,A as kt,h as Tt,p as Pt,C as qt}from"../chunks/setup.f6d951a4.js";import{G as Rt}from"../chunks/index.c7fb8798.js";import{D as zt,C as Dt}from"../chunks/code.759f5f5e.js";const It=l=>new _t({color:l,toneMapped:!1});class At extends X{constructor(n,e,r={}){var j,J;super();w(this,"isViewHelper",!0);w(this,"animating",!1);w(this,"center",new R);w(this,"turnRate",2*Math.PI);w(this,"dispose");const p=["x","y","z","x","y","z"],{position:u="top-right"}=r,f=e.domElement,o=new dt,m=window.devicePixelRatio,Y=r.colors??["#ff3653","#8adb00","#2c8fff"],x=new R,B=new z,_=new Mt,v=new z,M=new z,h=new bt,G=new ht;let b=0;const O=new wt(.5,.05,.05).translate(.4,0,0),F=Y.map(t=>new $t(t)),y=F.map(t=>new gt(O,It(t))),$=new X,V=new xt(-2,2,2,-2,0,4);V.position.set(0,0,2);const H=new R,i=220,g=document.createElement("div");f.before(g),(j=y[1])==null||j.rotation.set(0,0,Math.PI/2),(J=y[2])==null||J.rotation.set(0,-Math.PI/2,0),y.forEach(t=>this.add(t));const E=p.map((t,a)=>{const c=a>2?-1:1,C=new vt(F[a%3],c===1?t:void 0),d=new yt(C);return d.position[t]=c,d.scale.setScalar(c===1?1:.8),d.userData={name:t,sign:c},d});E.forEach(t=>this.add(t));const k=E.map(t=>{const a=document.createElement("div");return a.dataset.axis=t.userData.name,a.dataset.sign=t.userData.sign===1?"":"-",a.style.cssText=`
        position: absolute;
        width: 15px;
        height: 15px;
        border-radius: 100%;
        cursor: pointer;
      `,new Et({element:a,object3D:t,target:g})}),Z=Ct(f,t=>{o.x=t.width,o.y=t.height,g.style.cssText=`
        position: absolute;
        top: ${f.offsetTop}px;
        left: ${f.offsetLeft+(t.width-i/m)}px;
        width: ${i/m}px;
        height: ${i/m}px;
      `});let U=!1;const T=e.render,tt=t=>{switch(t){case"x":return h.set(0,Math.PI*.5,0);case"y":return h.set(-Math.PI*.5,0,0);case"z":return h.set(0,0,0);case"-x":return h.set(0,-Math.PI*.5,0);case"-y":return h.set(Math.PI*.5,0,0);case"-z":return h.set(0,Math.PI,0)}},et=()=>{this.quaternion.copy(n.quaternion).invert(),H.set(0,0,1).applyQuaternion(n.quaternion),p.forEach((c,C)=>{const d=E[C];d!==void 0&&(C<3?d.material.opacity=H[c]>=0?1:.5:d.material.opacity=H[c]<0?1:.5)}),U=e.autoClear,e.autoClear=!1,e.clearDepth(),e.getViewport(G);const t=o.x*m,a=o.y*m;switch(u){case"top-right":{e.setViewport(t-i,a-i,i,i);break}case"bottom-right":{e.setViewport(t-i,0,i,i);break}case"bottom-left":{e.setViewport(0,0,i,i);break}case"top-left":{e.setViewport(0,a-i,i,i);break}}T.call(e,this,V),e.setViewport(G),e.autoClear=U,k.forEach(c=>c.update(V,e))},st=()=>{const a=_.getDelta()*this.turnRate;v.rotateTowards(M,a),n.position.set(0,0,1).applyQuaternion(v).multiplyScalar(b).add(this.center),n.quaternion.rotateTowards(B,a),v.angleTo(M)===0&&(this.animating=!1,_.stop())},at=(t,a,c)=>{x.set(0,0,0),x[t]=a==="-"?-1:1,B.setFromEuler(tt(`${a}${t}`)),b=n.position.distanceTo(c),x.multiplyScalar(b).add(c),$.position.copy(c),$.lookAt(n.position),v.copy($.quaternion),$.lookAt(x),M.copy($.quaternion)},W=t=>{if(this.animating)return;const{axis:a,sign:c}=t.currentTarget.dataset;at(a,c,this.center),_.start(),this.animating=!0};k.forEach(t=>{var a;return(a=t.element)==null?void 0:a.addEventListener("click",W)}),e.render=(...t)=>{T.call(e,...t),et(),this.animating&&st()},this.dispose=()=>{e.render=T,k.forEach(t=>{var a;(a=t.element)==null||a.remove(),t.dispose()}),g.removeEventListener("click",W),g.remove(),Z.disconnect(),O.dispose(),y.forEach(t=>t.material.dispose()),E.forEach(t=>{var a;(a=t.material.map)==null||a.dispose(),t.material.dispose()})}}}const St=`
import * as THREE from 'three'
import { ViewHelper } from 'trzy'

const camera = new THREE.PerspectiveCamera()
const renderer = new THREE.WebGLRenderer()
const helper = new ViewHelper(camera, renderer)
`;function Lt(l){let s,n="Creates a HUD view helper.",e,r,p,u,f;return r=new qt({}),u=new Dt({props:{code:St}}),{c(){s=mt("p"),s.textContent=n,e=K(),D(r.$$.fragment),p=K(),D(u.$$.fragment)},l(o){s=ut(o,"P",{"data-svelte-h":!0}),ft(s)!=="svelte-3wvkbi"&&(s.textContent=n),e=N(o),I(r.$$.fragment,o),p=N(o),I(u.$$.fragment,o)},m(o,m){P(o,s,m),P(o,e,m),A(r,o,m),P(o,p,m),A(u,o,m),f=!0},p:ct,i(o){f||(S(r.$$.fragment,o),S(u.$$.fragment,o),f=!0)},o(o){L(r.$$.fragment,o),L(u.$$.fragment,o),f=!1},d(o){o&&(q(s),q(e),q(p)),Q(r,o),Q(u,o)}}}function Qt(l){let s,n;return s=new zt({props:{title:"ViewHelper",$$slots:{default:[Lt]},$$scope:{ctx:l}}}),{c(){D(s.$$.fragment)},l(e){I(s.$$.fragment,e)},m(e,r){A(s,e,r),n=!0},p(e,[r]){const p={};r&1&&(p.$$scope={dirty:r,ctx:e}),s.$set(p)},i(e){n||(S(s.$$.fragment,e),n=!0)},o(e){L(s.$$.fragment,e),n=!1},d(e){Q(s,e)}}}function Bt(l){return it(()=>{const s=Vt();s.autoRotate=!1;const{scene:n,camera:e,renderer:r}=Ht(),p=new At(e.current,r);return n.add(new Rt(.1,1,"#ccc")),n.add(new kt),n.add(Tt(Pt({color:"turquoise"}),.5,.4,.3)),()=>{s.autoRotate=!0,p.dispose()}}),[]}class Jt extends lt{constructor(s){super(),pt(this,s,Bt,Qt,rt,{})}}export{Jt as component};
