var ot=Object.defineProperty;var nt=(l,s,n)=>s in l?ot(l,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[s]=n;var $=(l,s,n)=>(nt(l,typeof s!="symbol"?s+"":s,n),n);import{s as rt,o as it,n as ct}from"../chunks/scheduler.b0c1c2c3.js";import{S as lt,i as pt,r as D,u as A,v as L,d as S,t as Q,w as B,g as mt,s as N,h as ut,z as ft,c as X,a as q,f as P}from"../chunks/index.f44ac6f0.js";import{O as Y,V as R,g as dt,q as ht,B as wt,M as $t,r as gt,t as xt,v as yt,H as vt,w as Et,x as Ct,y as _t,Q as I,z as bt,E as Mt,s as zt,u as Vt,A as Ht,p as kt,I as Tt,C as qt}from"../chunks/setup.ed225109.js";import{G as Pt}from"../chunks/index.fcaed192.js";import{D as Rt,C as It}from"../chunks/code.97b5a18f.js";const Dt=l=>new Ct({color:new _t(l),toneMapped:!1}),Z={x:"#ff3653",y:"#8adb00",z:"#2c8fff"};class At extends Y{constructor(n,e,i={}){var J,K;super();$(this,"isViewHelper",!0);$(this,"animating",!1);$(this,"center",new R);$(this,"turnRate",2*Math.PI);$(this,"dispose");const p=(i.axes??"xyz").split(""),m=["x","y","z","x","y","z"],{position:h="top-right"}=i,o=e.domElement,u=new dt,g=window.devicePixelRatio,v=new R,G=new I,b=new bt,E=new I,M=new I,w=new Mt,O=new ht;let z=0;const F=new wt(.5,.05,.05).translate(.4,0,0),C=p.map(t=>new $t(F,Dt(Z[t]))),x=new Y,V=new gt(-2,2,2,-2,0,4);V.position.set(0,0,2);const H=new R,c=220,y=document.createElement("div");o.before(y),(J=C[1])==null||J.rotation.set(0,0,Math.PI/2),(K=C[2])==null||K.rotation.set(0,-Math.PI/2,0),C.forEach(t=>this.add(t));const _=m.map((t,a)=>{const r=a>2?-1:1,d=new xt(Z[p[a%3]],r===1?p[a]:void 0),f=new yt(d);return f.position[t]=r,f.scale.setScalar(r===1?1:.8),f.userData={name:t,sign:r},f});_.forEach(t=>this.add(t));const k=_.map(t=>{const a=document.createElement("div"),r=t.userData.name,d=t.userData.sign===1?"":"-";return a.role="button",a.ariaLabel=`${d}${r}`,a.dataset.axis=r,a.dataset.sign=d,a.style.cssText=`
        position: absolute;
        width: 15px;
        height: 15px;
        border-radius: 100%;
        cursor: pointer;
      `,new vt({element:a,object3D:t,target:y})}),j=Et(o,t=>{u.x=t.width,u.y=t.height,y.style.cssText=`
        position: absolute;
        top: ${o.offsetTop}px;
        left: ${o.offsetLeft+(t.width-c/g)}px;
        width: ${c/g}px;
        height: ${c/g}px;
      `});let U=!1;const T=e.render,tt=t=>{switch(t){case"x":return w.set(0,Math.PI*.5,0);case"y":return w.set(-Math.PI*.5,0,0);case"z":return w.set(0,0,0);case"-x":return w.set(0,-Math.PI*.5,0);case"-y":return w.set(Math.PI*.5,0,0);case"-z":return w.set(0,Math.PI,0)}},et=()=>{this.quaternion.copy(n.quaternion).invert(),H.set(0,0,1).applyQuaternion(n.quaternion),m.forEach((r,d)=>{const f=_[d];f!==void 0&&(d<3?f.material.opacity=H[r]>=0?1:.5:f.material.opacity=H[r]<0?1:.5)}),U=e.autoClear,e.autoClear=!1,e.clearDepth(),e.getViewport(O);const t=u.x*g,a=u.y*g;switch(h){case"top-right":{e.setViewport(t-c,a-c,c,c);break}case"bottom-right":{e.setViewport(t-c,0,c,c);break}case"bottom-left":{e.setViewport(0,0,c,c);break}case"top-left":{e.setViewport(0,a-c,c,c);break}}T.call(e,this,V),e.setViewport(O),e.autoClear=U,k.forEach(r=>r.update(V,e))},st=()=>{const a=b.getDelta()*this.turnRate;E.rotateTowards(M,a),n.position.set(0,0,1).applyQuaternion(E).multiplyScalar(z).add(this.center),n.quaternion.rotateTowards(G,a),E.angleTo(M)===0&&(this.animating=!1,b.stop())},at=(t,a,r)=>{v.set(0,0,0),v[t]=a==="-"?-1:1,G.setFromEuler(tt(`${a}${t}`)),z=n.position.distanceTo(r),v.multiplyScalar(z).add(r),x.position.copy(r),x.lookAt(n.position),E.copy(x.quaternion),x.lookAt(v),M.copy(x.quaternion)},W=t=>{if(this.animating)return;const{axis:a,sign:r}=t.currentTarget.dataset;at(a,r,this.center),b.start(),this.animating=!0};k.forEach(t=>{var a;return(a=t.element)==null?void 0:a.addEventListener("click",W)}),e.render=(...t)=>{T.call(e,...t),et(),this.animating&&st()},this.dispose=()=>{e.render=T,k.forEach(t=>{var a;(a=t.element)==null||a.remove(),t.dispose()}),y.removeEventListener("click",W),y.remove(),j.disconnect(),F.dispose(),C.forEach(t=>t.material.dispose()),_.forEach(t=>{var a;(a=t.material.map)==null||a.dispose(),t.material.dispose()})}}}const Lt=`
import * as THREE from 'three'
import { ViewHelper } from 'trzy'

const camera = new THREE.PerspectiveCamera()
const renderer = new THREE.WebGLRenderer()
const helper = new ViewHelper(camera, renderer, { axes: 'yzx' /* default xyz */ })
`;function St(l){let s,n="Creates a HUD view helper.",e,i,p,m,h;return i=new qt({}),m=new It({props:{code:Lt}}),{c(){s=mt("p"),s.textContent=n,e=N(),D(i.$$.fragment),p=N(),D(m.$$.fragment)},l(o){s=ut(o,"P",{"data-svelte-h":!0}),ft(s)!=="svelte-3wvkbi"&&(s.textContent=n),e=X(o),A(i.$$.fragment,o),p=X(o),A(m.$$.fragment,o)},m(o,u){q(o,s,u),q(o,e,u),L(i,o,u),q(o,p,u),L(m,o,u),h=!0},p:ct,i(o){h||(S(i.$$.fragment,o),S(m.$$.fragment,o),h=!0)},o(o){Q(i.$$.fragment,o),Q(m.$$.fragment,o),h=!1},d(o){o&&(P(s),P(e),P(p)),B(i,o),B(m,o)}}}function Qt(l){let s,n;return s=new Rt({props:{title:"ViewHelper",$$slots:{default:[St]},$$scope:{ctx:l}}}),{c(){D(s.$$.fragment)},l(e){A(s.$$.fragment,e)},m(e,i){L(s,e,i),n=!0},p(e,[i]){const p={};i&1&&(p.$$scope={dirty:i,ctx:e}),s.$set(p)},i(e){n||(S(s.$$.fragment,e),n=!0)},o(e){Q(s.$$.fragment,e),n=!1},d(e){B(s,e)}}}function Bt(l){return it(()=>{const s=zt();s.autoRotate=!1;const{scene:n,camera:e,renderer:i}=Vt(),p=new At(e.current,i,{axes:"yzx"});return n.add(new Pt(.1,1,"#ccc")),n.add(new Ht),n.add(kt(Tt({color:"turquoise"}),.5,.4,.3)),()=>{s.autoRotate=!0,p.dispose()}}),[]}class Kt extends lt{constructor(s){super(),pt(this,s,Bt,Qt,rt,{})}}export{Kt as component};
