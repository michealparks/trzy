{"version":3,"file":"index.stories-7099185f.js","sources":["../../src/components/gamepad/index.ts","../../src/components/gamepad/code.js?raw"],"sourcesContent":["const createGamepad = (player: number) => ({\n  player,\n  id: '',\n  A: 0,\n  B: 0,\n  X: 0,\n  Y: 0,\n  back: 0,\n  connected: false,\n  leftBumper: 0,\n  leftStickButton: 0,\n  leftStickX: 0,\n  leftStickY: 0,\n  leftTrigger: 0,\n  padX: 0,\n  padY: 0,\n  rightBumper: 0,\n  rightStickButton: 0,\n  rightStickX: 0,\n  rightStickY: 0,\n  rightTrigger: 0,\n  start: 0,\n})\n\ntype Pad = ReturnType<typeof createGamepad>\n\nlet initialized = false\n\nconst gamepads = [1, 2, 3, 4].map((player) => createGamepad(player))\n\nconst handleGamepad = (pad: Pad, { axes, buttons }: Gamepad): void => {\n  pad.leftStickX = axes[0] ?? 0\n  pad.leftStickY = axes[1] ?? 0\n  pad.rightStickX = axes[2] ?? 0\n  pad.rightStickY = axes[3] ?? 0\n\n  pad.A = buttons[0]?.value ?? 0\n  pad.B = buttons[1]?.value ?? 0\n  pad.X = buttons[2]?.value ?? 0\n  pad.Y = buttons[3]?.value ?? 0\n\n  pad.leftBumper = buttons[4]?.value ?? 0\n  pad.rightBumper = buttons[5]?.value ?? 0\n  pad.leftTrigger = buttons[6]?.value ?? 0\n  pad.rightTrigger = buttons[7]?.value ?? 0\n\n  pad.back = buttons[8]?.value ?? 0\n  pad.start = buttons[9]?.value ?? 0\n\n  pad.leftStickButton = buttons[10]?.value ?? 0\n  pad.rightStickButton = buttons[11]?.value ?? 0\n\n  pad.padY = -buttons[12]!.value || buttons[13]!.value\n  pad.padX = -buttons[14]!.value || buttons[15]!.value\n}\n\nconst updateGamepads = (): void => {\n  navigator.getGamepads().forEach((pad, index) => {\n    if (pad === null) {\n      return\n    }\n\n    handleGamepad(gamepads[index]!, pad)\n  })\n}\n\nconst handleGamepadDisconnected = (event: GamepadEvent): void => {\n  const { id } = event.gamepad\n\n  gamepads.forEach((gamepad) => {\n    if (id === gamepad.id) {\n      gamepad.connected = false\n    }\n  })\n}\n\nconst handleGamepadConnected = (): void => {\n  navigator.getGamepads().forEach((pad, index) => {\n    gamepads[index]!.connected = pad !== null\n    gamepads[index]!.id = pad?.id ?? ''\n  })\n}\n\nconst disposeGamepads = (): void => {\n  window.removeEventListener('gamepadconnected', handleGamepadConnected)\n  window.removeEventListener('gamepaddisconnected', handleGamepadDisconnected)\n  initialized = false\n}\n\nexport const useGamepad = (): {\n  gamepad: Readonly<Pad>\n  gamepads: Readonly<Pad>[]\n  updateGamepads: () => void\n  disposeGamepads: () => void\n} => {\n  if (!initialized) {\n    window.addEventListener('gamepadconnected', handleGamepadConnected)\n    window.addEventListener('gamepaddisconnected', handleGamepadDisconnected)\n    initialized = true\n  }\n\n  return { gamepad: gamepads[0]!, gamepads, updateGamepads, disposeGamepads }\n}\n","export default \"import { useGamepad } from 'trzy'\\n\\nconst { gamepad1, gamepad2, updateGamepads, disposeGamepads } = useGamepad()\\n\\n// In your game loop\\nupdateGamepads()\\n\\n// later\\ndisposeGamepads()\\n\""],"names":["createGamepad","player","initialized","gamepads","handleGamepad","pad","axes","buttons","_a","_b","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","updateGamepads","index","handleGamepadDisconnected","event","id","gamepad","handleGamepadConnected","disposeGamepads","useGamepad","code"],"mappings":"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"}