var J=Object.defineProperty;var K=(n,o,s)=>o in n?J(n,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[o]=s;var p=(n,o,s)=>(K(n,typeof o!="symbol"?o+"":o,s),s);import{O as Q,V as R,B as N,C as Z,b as $,R as tt,e as et,f as st,S as at,g as nt,h as ot,i as rt,j as it,k as ct,Q as S,E as lt,u as pt,s as ut,A as mt}from"./setup-bf23c97c.js";const dt=n=>new nt({color:n,toneMapped:!1}),ht=(n,o)=>{const s=document.createElement("canvas"),e=s.getContext("2d");s.width=64,s.height=64,e!==null&&(e.beginPath(),e.arc(32,32,16,0,2*Math.PI),e.closePath(),e.fillStyle=(n==null?void 0:n.getStyle())??"",e.fill(),o!==void 0&&(e.font="24px system-ui",e.textAlign="center",e.fillStyle="#000000",e.fillText(o.toUpperCase(),32,41)));const E=new ot(s);return new rt({map:E,toneMapped:!1})};class ft extends Q{constructor(s,e,E={}){var z,L;super();p(this,"isViewHelper",!0);p(this,"animating",!1);p(this,"center",new R);p(this,"turnRate",2*Math.PI);p(this,"dispose");const T=["x","y","z","x","y","z"],i=e.domElement,F=E.colors??["#ff3653","#8adb00","#2c8fff"],d=new R,I=new S,G=new it,h=new S,x=new S,c=new lt,k=new ct;let v=0;const q=new N(.8,.05,.05).translate(.4,0,0),A=F.map(t=>new Z(t)),f=A.map(t=>new $(q,dt(t))),D=new tt,M=new et,u=new Q,C=new st(-2,2,2,-2,0,4);C.position.set(0,0,2),(z=f[1])==null||z.rotation.set(0,0,Math.PI/2),(L=f[2])==null||L.rotation.set(0,-Math.PI/2,0),f.forEach(t=>this.add(t));const w=T.map((t,a)=>{const r=a>2?-1:1,g=ht(A[a%3],r===1?t:void 0),l=new at(g);return l.position[t]=r,l.scale.setScalar(r===1?1:.8),l.userData={name:t,sign:r},l});w.forEach(t=>this.add(t));const P=new R,m=220;let b=!1;const V=e.render,X=t=>{switch(t){case"x":return c.set(0,Math.PI*.5,0);case"y":return c.set(-Math.PI*.5,0,0);case"z":return c.set(0,0,0);case"-x":return c.set(0,-Math.PI*.5,0);case"-y":return c.set(Math.PI*.5,0,0);case"-z":return c.set(0,Math.PI,0)}},Y=()=>{this.quaternion.copy(s.quaternion).invert(),P.set(0,0,1).applyQuaternion(s.quaternion),T.forEach((t,a)=>{const r=w[a];r!==void 0&&(a<3?r.material.opacity=P[t]>=0?1:.5:r.material.opacity=P[t]<0?1:.5)}),b=e.autoClear,e.autoClear=!1,e.clearDepth(),e.getViewport(k),e.setViewport(i.offsetWidth*window.devicePixelRatio-m,0,m,m),V.call(e,this,C),e.setViewport(k),e.autoClear=b},_=t=>{const a=t*this.turnRate;h.rotateTowards(x,a),s.position.set(0,0,1).applyQuaternion(h).multiplyScalar(v).add(this.center),s.quaternion.rotateTowards(I,a),h.angleTo(x)===0&&(this.animating=!1)},U=(t,a)=>{d.set(0,0,0),d[t.userData.name]=t.userData.sign,I.setFromEuler(X(t.userData.name)),v=s.position.distanceTo(a),d.multiplyScalar(v).add(a),u.position.copy(a),u.lookAt(s.position),h.copy(u.quaternion),u.lookAt(d),x.copy(u.quaternion)},H=t=>{if(this.animating)return;const a=i.getBoundingClientRect(),r=a.left+(i.offsetWidth-m),g=a.top+(i.offsetHeight-m);M.x=(t.clientX-r)/(a.right-r)*2-1,M.y=-((t.clientY-g)/(a.bottom-g)*2)+1,D.setFromCamera(M,C);const l=D.intersectObjects(w),[O]=l;O!==void 0&&(U(O.object,this.center),this.animating=!0)};e.render=(...t)=>{V.call(e,...t),Y(),this.animating&&_(G.getDelta())},i.addEventListener("click",H),i.addEventListener("mousemove",H),this.dispose=()=>{i.removeEventListener("click",H),e.render=V,q.dispose(),f.forEach(t=>t.material.dispose()),w.forEach(t=>{var a;(a=t.material.map)==null||a.dispose(),t.material.dispose()})}}}const wt=`import * as THREE from 'three'
import { ViewHelper } from 'trzy'

const camera = new THREE.PerspectiveCamera()
const renderer = new THREE.WebGLRenderer()
const helper = new ViewHelper(camera, renderer)
`,xt={title:"ViewHelper",parameters:{docs:{source:{code:wt}}}},gt=()=>{const{scene:n,camera:o,renderer:s}=pt(),e=document.createElement("div");return e.append(s.domElement),ut(),new ft(o.current,s),n.add(new mt),e},y={render:gt};var B,W,j;y.parameters={...y.parameters,docs:{...(B=y.parameters)==null?void 0:B.docs,source:{originalSource:`{
  render
}`,...(j=(W=y.parameters)==null?void 0:W.docs)==null?void 0:j.source}}};const vt=["Primary"];export{y as Primary,vt as __namedExportsOrder,xt as default};
//# sourceMappingURL=view-helper.stories-6841a1e1.js.map
