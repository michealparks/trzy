{"version":3,"file":"keyboard.stories-0e0e8051.js","sources":["../../src/controls/keyboard.ts"],"sourcesContent":["export const keyboardManager = () => {\n  const pressedKeys = new Set<string>()\n\n  const keyboard = {\n    controlling: false,\n    shift: 0,\n    space: 0,\n    r: 0,\n    x: 0,\n    y: 0,\n  }\n\n  const handleKey = (key: string, pressed: number) => {\n    switch (key.toLowerCase()) {\n    case 's':\n    case 'arrowdown':\n      keyboard.y = -1 * pressed\n      break\n    case 'w':\n    case 'arrowup':\n      keyboard.y = +1 * pressed\n      break\n    case 'a':\n    case 'arrowleft':\n      keyboard.x = -1 * pressed\n      break\n    case 'd':\n    case 'arrowright':\n      keyboard.x = +1 * pressed\n      break\n    case ' ':\n      keyboard.space = +1 * pressed\n      break\n    case 'q':\n      keyboard.r = +1 * pressed\n      break\n    case 'e':\n      keyboard.r = -1 * pressed\n      break\n    case 'shift':\n      keyboard.shift = +1 * pressed\n      break\n    default:\n      break\n    }\n  }\n\n  const handleKeyDown = (event: { key: string }) => {\n    const key = event.key.toLowerCase()\n    keyboard.controlling = true\n  \n    pressedKeys.add(key)\n  \n    for (const pressedKey of pressedKeys) {\n      handleKey(pressedKey, 1)\n    }\n  }\n\n  const handleKeyUp = (event: { key: string }) => {\n    const key = event.key.toLowerCase()\n    pressedKeys.delete(key)\n  \n    handleKey(key, 0)\n  \n    for (const pressedKey of pressedKeys) {\n      handleKey(pressedKey, 1)\n    }\n  \n    if (pressedKeys.size === 0) {\n      keyboard.controlling = false\n    }\n  }  \n\n  const dispose = () => {\n    window.removeEventListener('keydown', handleKeyDown)\n    window.removeEventListener('keyup', handleKeyUp)\n  }\n\n  window.addEventListener('keydown', handleKeyDown, { passive: true })\n  window.addEventListener('keyup', handleKeyUp, { passive: true })\n\n  return { keyboard, dispose }\n}\n"],"names":["keyboardManager","pressedKeys","keyboard","handleKey","key","pressed","handleKeyDown","event","pressedKey","handleKeyUp","dispose"],"mappings":"+CAAO,MAAMA,EAAkB,IAAM,CAC7B,MAAAC,MAAkB,IAElBC,EAAW,CACf,YAAa,GACb,MAAO,EACP,MAAO,EACP,EAAG,EACH,EAAG,EACH,EAAG,CAAA,EAGCC,EAAY,CAACC,EAAaC,IAAoB,CAC1C,OAAAD,EAAI,YAAe,EAAA,CAC3B,IAAK,IACL,IAAK,YACHF,EAAS,EAAI,GAAKG,EAClB,MACF,IAAK,IACL,IAAK,UACHH,EAAS,EAAI,EAAKG,EAClB,MACF,IAAK,IACL,IAAK,YACHH,EAAS,EAAI,GAAKG,EAClB,MACF,IAAK,IACL,IAAK,aACHH,EAAS,EAAI,EAAKG,EAClB,MACF,IAAK,IACHH,EAAS,MAAQ,EAAKG,EACtB,MACF,IAAK,IACHH,EAAS,EAAI,EAAKG,EAClB,MACF,IAAK,IACHH,EAAS,EAAI,GAAKG,EAClB,MACF,IAAK,QACHH,EAAS,MAAQ,EAAKG,EACtB,KAGF,CAAA,EAGIC,EAAiBC,GAA2B,CAC1C,MAAAH,EAAMG,EAAM,IAAI,YAAY,EAClCL,EAAS,YAAc,GAEvBD,EAAY,IAAIG,CAAG,EAEnB,UAAWI,KAAcP,EACvBE,EAAUK,EAAY,CAAC,CACzB,EAGIC,EAAeF,GAA2B,CACxC,MAAAH,EAAMG,EAAM,IAAI,YAAY,EAClCN,EAAY,OAAOG,CAAG,EAEtBD,EAAUC,EAAK,CAAC,EAEhB,UAAWI,KAAcP,EACvBE,EAAUK,EAAY,CAAC,EAGrBP,EAAY,OAAS,IACvBC,EAAS,YAAc,GACzB,EAGIQ,EAAU,IAAM,CACb,OAAA,oBAAoB,UAAWJ,CAAa,EAC5C,OAAA,oBAAoB,QAASG,CAAW,CAAA,EAGjD,cAAO,iBAAiB,UAAWH,EAAe,CAAE,QAAS,GAAM,EACnE,OAAO,iBAAiB,QAASG,EAAa,CAAE,QAAS,GAAM,EAExD,CAAE,SAAAP,EAAU,QAAAQ,EACrB;;;;;;;;;;;;;;;;;;;;;;;;;;"}