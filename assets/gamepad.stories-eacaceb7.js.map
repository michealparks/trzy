{"version":3,"file":"gamepad.stories-eacaceb7.js","sources":["../../src/components/controls/gamepad.ts"],"sourcesContent":["const createGamepad = () => ({\n  id: '',\n  A: 0,\n  B: 0,\n  X: 0,\n  Y: 0,\n  back: 0,\n  connected: false,\n  leftBumper: 0,\n  leftStickButton: 0,\n  leftStickX: 0,\n  leftStickY: 0,\n  leftTrigger: 0,\n  padX: 0,\n  padY: 0,\n  rightBumper: 0,\n  rightStickButton: 0,\n  rightStickX: 0,\n  rightStickY: 0,\n  rightTrigger: 0,\n  start: 0,\n})\n\nlet initialized = false\n\nconst gamepad = createGamepad()\nconst gamepad2 = createGamepad()\n\nconst handleGamepad = (pad: ReturnType<typeof createGamepad>, { axes, buttons }: Gamepad) => {\n  pad.leftStickX = axes[0] ?? 0\n  pad.leftStickY = axes[1] ?? 0\n  pad.rightStickX = axes[2] ?? 0\n  pad.rightStickY = axes[3] ?? 0\n\n  pad.A = buttons[0]?.value ?? 0\n  pad.B = buttons[1]?.value ?? 0\n  pad.X = buttons[2]?.value ?? 0\n  pad.Y = buttons[3]?.value ?? 0\n\n  pad.leftBumper = buttons[4]?.value ?? 0\n  pad.rightBumper = buttons[5]?.value ?? 0\n  pad.leftTrigger = buttons[6]?.value ?? 0\n  pad.rightTrigger = buttons[7]?.value ?? 0\n\n  pad.back = buttons[8]?.value ?? 0\n  pad.start = buttons[9]?.value ?? 0\n\n  pad.leftStickButton = buttons[10]?.value ?? 0\n  pad.rightStickButton = buttons[11]?.value ?? 0\n\n  pad.padY = -buttons[12]!.value || buttons[13]!.value\n  pad.padX = -buttons[14]!.value || buttons[15]!.value\n}\n\nconst updateGamepad = () => {\n  const [pad1, pad2] = window.navigator.getGamepads()\n\n  if (pad1 !== null && pad1 !== undefined) {\n    handleGamepad(gamepad, pad1)\n  }\n\n  if (pad2 !== null && pad2 !== undefined) {\n    handleGamepad(gamepad2, pad2)\n  }\n}\n\nconst handleGamepadDisconnected = (event: GamepadEvent) => {\n  const { id } = event.gamepad\n\n  if (id === gamepad.id) {\n    gamepad.connected = false\n  } else if (id === gamepad2.id) {\n    gamepad2.connected = false\n  }\n}\n\nconst handleGamepadConnected = () => {\n  const [pad1, pad2] = window.navigator.getGamepads()\n\n  gamepad.connected = pad1 !== null && pad1 !== undefined\n  gamepad.id = pad1?.id ?? ''\n\n  gamepad2.connected = pad2 !== null && pad2 !== undefined\n  gamepad2.id = pad2?.id ?? ''\n}\n\nconst disposeGamepad = () => {\n  window.removeEventListener('gamepadconnected', handleGamepadConnected)\n  window.removeEventListener('gamepaddisconnected', handleGamepadDisconnected)\n  initialized = false\n}\n\nexport const useGamepad = (): {\n  gamepad: Readonly<ReturnType<typeof createGamepad>>\n  gamepad2: Readonly<ReturnType<typeof createGamepad>>\n  updateGamepad(): void\n  disposeGamepad(): void\n} => {\n  if (!initialized) {\n    window.addEventListener('gamepadconnected', handleGamepadConnected)\n    window.addEventListener('gamepaddisconnected', handleGamepadDisconnected)\n    initialized = true\n  }\n\n  return { gamepad, gamepad2, updateGamepad, disposeGamepad }\n}\n"],"names":["createGamepad","initialized","gamepad","gamepad2","handleGamepad","pad","axes","buttons","_a","_b","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","updateGamepad","pad1","pad2","handleGamepadDisconnected","event","id","handleGamepadConnected","disposeGamepad","useGamepad"],"mappings":"4BAAA,MAAMA,EAAgB,KAAO,CAC3B,GAAI,GACJ,EAAG,EACH,EAAG,EACH,EAAG,EACH,EAAG,EACH,KAAM,EACN,UAAW,GACX,WAAY,EACZ,gBAAiB,EACjB,WAAY,EACZ,WAAY,EACZ,YAAa,EACb,KAAM,EACN,KAAM,EACN,YAAa,EACb,iBAAkB,EAClB,YAAa,EACb,YAAa,EACb,aAAc,EACd,MAAO,CACT,GAEA,IAAIC,EAAc,GAElB,MAAMC,EAAUF,EAAc,EACxBG,EAAWH,EAAc,EAEzBI,EAAgB,CAACC,EAAuC,CAAE,KAAAC,EAAM,QAAAC,KAAuB,6BACvFF,EAAA,WAAaC,EAAK,CAAC,GAAK,EACxBD,EAAA,WAAaC,EAAK,CAAC,GAAK,EACxBD,EAAA,YAAcC,EAAK,CAAC,GAAK,EACzBD,EAAA,YAAcC,EAAK,CAAC,GAAK,EAE7BD,EAAI,IAAIG,EAAAD,EAAQ,CAAC,IAAT,YAAAC,EAAY,QAAS,EAC7BH,EAAI,IAAII,EAAAF,EAAQ,CAAC,IAAT,YAAAE,EAAY,QAAS,EAC7BJ,EAAI,IAAIK,EAAAH,EAAQ,CAAC,IAAT,YAAAG,EAAY,QAAS,EAC7BL,EAAI,IAAIM,EAAAJ,EAAQ,CAAC,IAAT,YAAAI,EAAY,QAAS,EAE7BN,EAAI,aAAaO,EAAAL,EAAQ,CAAC,IAAT,YAAAK,EAAY,QAAS,EACtCP,EAAI,cAAcQ,EAAAN,EAAQ,CAAC,IAAT,YAAAM,EAAY,QAAS,EACvCR,EAAI,cAAcS,EAAAP,EAAQ,CAAC,IAAT,YAAAO,EAAY,QAAS,EACvCT,EAAI,eAAeU,EAAAR,EAAQ,CAAC,IAAT,YAAAQ,EAAY,QAAS,EAExCV,EAAI,OAAOW,EAAAT,EAAQ,CAAC,IAAT,YAAAS,EAAY,QAAS,EAChCX,EAAI,QAAQY,EAAAV,EAAQ,CAAC,IAAT,YAAAU,EAAY,QAAS,EAEjCZ,EAAI,kBAAkBa,EAAAX,EAAQ,EAAE,IAAV,YAAAW,EAAa,QAAS,EAC5Cb,EAAI,mBAAmBc,EAAAZ,EAAQ,EAAE,IAAV,YAAAY,EAAa,QAAS,EAEzCd,EAAA,KAAO,CAACE,EAAQ,EAAE,EAAG,OAASA,EAAQ,EAAE,EAAG,MAC3CF,EAAA,KAAO,CAACE,EAAQ,EAAE,EAAG,OAASA,EAAQ,EAAE,EAAG,KACjD,EAEMa,EAAgB,IAAM,CAC1B,KAAM,CAACC,EAAMC,CAAI,EAAI,OAAO,UAAU,cAElCD,GAAS,MACXjB,EAAcF,EAASmB,CAAI,EAGzBC,GAAS,MACXlB,EAAcD,EAAUmB,CAAI,CAEhC,EAEMC,EAA6BC,GAAwB,CACnD,KAAA,CAAE,GAAAC,CAAG,EAAID,EAAM,QAEjBC,IAAOvB,EAAQ,GACjBA,EAAQ,UAAY,GACXuB,IAAOtB,EAAS,KACzBA,EAAS,UAAY,GAEzB,EAEMuB,EAAyB,IAAM,CACnC,KAAM,CAACL,EAAMC,CAAI,EAAI,OAAO,UAAU,cAE9BpB,EAAA,UAAYmB,GAAS,KACrBnB,EAAA,IAAKmB,GAAA,YAAAA,EAAM,KAAM,GAEhBlB,EAAA,UAAYmB,GAAS,KACrBnB,EAAA,IAAKmB,GAAA,YAAAA,EAAM,KAAM,EAC5B,EAEMK,EAAiB,IAAM,CACpB,OAAA,oBAAoB,mBAAoBD,CAAsB,EAC9D,OAAA,oBAAoB,sBAAuBH,CAAyB,EAC7DtB,EAAA,EAChB,EAEa2B,EAAa,KAMnB3B,IACI,OAAA,iBAAiB,mBAAoByB,CAAsB,EAC3D,OAAA,iBAAiB,sBAAuBH,CAAyB,EAC1DtB,EAAA,IAGT,CAAE,QAAAC,EAAS,SAAAC,EAAU,cAAAiB,EAAe,eAAAO,CAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}