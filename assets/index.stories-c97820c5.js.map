{"version":3,"file":"index.stories-c97820c5.js","sources":["../../src/components/gamepad/index.ts","../../src/components/gamepad/code.js?raw"],"sourcesContent":["const createGamepad = () => ({\n  id: '',\n  A: 0,\n  B: 0,\n  X: 0,\n  Y: 0,\n  back: 0,\n  connected: false,\n  leftBumper: 0,\n  leftStickButton: 0,\n  leftStickX: 0,\n  leftStickY: 0,\n  leftTrigger: 0,\n  padX: 0,\n  padY: 0,\n  rightBumper: 0,\n  rightStickButton: 0,\n  rightStickX: 0,\n  rightStickY: 0,\n  rightTrigger: 0,\n  start: 0,\n})\n\ntype Pad = ReturnType<typeof createGamepad>\n\nlet initialized = false\n\nconst gamepad1 = createGamepad()\nconst gamepad2 = createGamepad()\nconst gamepad3 = createGamepad()\nconst gamepad4 = createGamepad()\n\nconst handleGamepad = (pad: Pad, { axes, buttons }: Gamepad): void => {\n  pad.leftStickX = axes[0] ?? 0\n  pad.leftStickY = axes[1] ?? 0\n  pad.rightStickX = axes[2] ?? 0\n  pad.rightStickY = axes[3] ?? 0\n\n  pad.A = buttons[0]?.value ?? 0\n  pad.B = buttons[1]?.value ?? 0\n  pad.X = buttons[2]?.value ?? 0\n  pad.Y = buttons[3]?.value ?? 0\n\n  pad.leftBumper = buttons[4]?.value ?? 0\n  pad.rightBumper = buttons[5]?.value ?? 0\n  pad.leftTrigger = buttons[6]?.value ?? 0\n  pad.rightTrigger = buttons[7]?.value ?? 0\n\n  pad.back = buttons[8]?.value ?? 0\n  pad.start = buttons[9]?.value ?? 0\n\n  pad.leftStickButton = buttons[10]?.value ?? 0\n  pad.rightStickButton = buttons[11]?.value ?? 0\n\n  pad.padY = -buttons[12]!.value || buttons[13]!.value\n  pad.padX = -buttons[14]!.value || buttons[15]!.value\n}\n\nconst updateGamepads = (): void => {\n  const [pad1, pad2, pad3, pad4] = window.navigator.getGamepads()\n\n  if (pad1 !== null && pad1 !== undefined) {\n    handleGamepad(gamepad1, pad1)\n  }\n\n  if (pad2 !== null && pad2 !== undefined) {\n    handleGamepad(gamepad2, pad2)\n  }\n\n  if (pad3 !== null && pad3 !== undefined) {\n    handleGamepad(gamepad3, pad3)\n  }\n\n  if (pad4 !== null && pad4 !== undefined) {\n    handleGamepad(gamepad4, pad4)\n  }\n}\n\nconst handleGamepadDisconnected = (event: GamepadEvent): void => {\n  const { id } = event.gamepad\n\n  if (id === gamepad1.id) {\n    gamepad1.connected = false\n  } else if (id === gamepad2.id) {\n    gamepad2.connected = false\n  }\n}\n\nconst handleGamepadConnected = (): void => {\n  const [pad1, pad2] = window.navigator.getGamepads()\n\n  gamepad1.connected = (pad1 !== null && pad1 !== undefined)\n  gamepad1.id = pad1?.id ?? ''\n\n  gamepad2.connected = (pad2 !== null && pad2 !== undefined)\n  gamepad2.id = pad2?.id ?? ''\n}\n\nconst disposeGamepads = (): void => {\n  window.removeEventListener('gamepadconnected', handleGamepadConnected)\n  window.removeEventListener('gamepaddisconnected', handleGamepadDisconnected)\n  initialized = false\n}\n\nexport const useGamepad = (): {\n  gamepad1: Readonly<Pad>\n  gamepad2: Readonly<Pad>\n  updateGamepads: () => void\n  disposeGamepads: () => void\n} => {\n  if (!initialized) {\n    window.addEventListener('gamepadconnected', handleGamepadConnected)\n    window.addEventListener('gamepaddisconnected', handleGamepadDisconnected)\n    initialized = true\n  }\n\n  return { gamepad1, gamepad2, updateGamepads, disposeGamepads }\n}\n","export default \"import { useGamepad, raf } from 'trzy'\\n\\nconst { gamepad1, gamepad2, updateGamepads, disposeGamepads } = useGamepad()\\n\\nraf(() => {\\n  updateGamepads()\\n})\\n\\n// later\\ndisposeGamepads()\\n\""],"names":["createGamepad","initialized","gamepad1","gamepad2","gamepad3","gamepad4","handleGamepad","pad","axes","buttons","_a","_b","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","updateGamepads","pad1","pad2","pad3","pad4","handleGamepadDisconnected","event","id","handleGamepadConnected","disposeGamepads","useGamepad","code"],"mappings":"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"}